(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{40:function(e,t,n){e.exports=n(74)},72:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(34),u=n.n(o),s=n(5),c=n(76),i=n(39),l=n(49),h=n(75),p=n(77),E=function(e){return{loggedIn:e.session.isAuthenticated}},m=Object(p.a)(Object(s.b)(E)(function(e){var t=e.component,n=e.path,r=e.loggedIn,o=e.exact;return a.a.createElement(l.a,{path:n,exact:o,render:function(e){return r?a.a.createElement(h.a,{to:"/tweets"}):a.a.createElement(t,e)}})})),d=Object(p.a)(Object(s.b)(E)(function(e){var t=e.component,n=e.loggedIn,r=Object(i.a)(e,["component","loggedIn"]);return a.a.createElement(l.a,Object.assign({},r,{render:function(e){return n?a.a.createElement(t,e):a.a.createElement(h.a,{to:"/login"})}}))})),f=n(79),b=n(14),v=n.n(b),w=function(e){e?v.a.defaults.headers.common.Authorization=e:delete v.a.defaults.headers.common.Authorization},O=n(21),j=n.n(O),g=function(e){return{type:"RECEIVE_SESSION_ERRORS",errors:e}},y=function(e){return function(t){return(n=e,v.a.post("/api/users/register",n)).then(function(){return t({type:"RECEIVE_USER_SIGN_IN"})},function(e){return t(g(e.response.data))});var n}},S=function(e){return function(t){return(n=e,v.a.post("/api/users/login",n)).then(function(e){var n=e.data.token;localStorage.setItem("jwtToken",n),w(n);var r=j()(n);t({type:"RECEIVE_CURRENT_USER",currentUser:r})}).catch(function(e){t(g(e.response.data))});var n}},T=function(){return function(e){localStorage.removeItem("jwtToken"),w(!1),e({type:"RECEIVE_USER_LOGOUT"})}},k=n(6),R=n(7),C=n(9),I=n(8),_=n(10),U=n(3),x=n(78),W=(n(72),function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this,e))).logoutUser=n.logoutUser.bind(Object(U.a)(Object(U.a)(n))),n.getLinks=n.getLinks.bind(Object(U.a)(Object(U.a)(n))),n}return Object(_.a)(t,e),Object(R.a)(t,[{key:"logoutUser",value:function(e){e.preventDefault(),this.props.logout()}},{key:"getLinks",value:function(){return this.props.loggedIn?a.a.createElement("div",null,a.a.createElement(x.a,{to:"/tweets"},"All Tweets"),a.a.createElement(x.a,{to:"/profile"},"Profile"),a.a.createElement(x.a,{to:"/new_tweet"},"Write a Tweet"),a.a.createElement("button",{onClick:this.logoutUser},"Logout")):a.a.createElement("div",null,a.a.createElement(x.a,{to:"/signup"},"Signup"),a.a.createElement(x.a,{to:"/login"},"Login"))}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h1",null,"Chirper"),this.getLinks())}}]),t}(a.a.Component)),V=Object(s.b)(function(e){return{loggedIn:e.session.isAuthenticated}},{logout:T})(W),N=function(){return function(e){return v.a.get("/api/tweets").then(function(t){return e(function(e){return{type:"RECEIVE_TWEETS",tweets:e}}(t))}).catch(function(e){return console.log(e)})}},A=function(e){return function(t){return function(e){return v.a.get("/api/tweets/user/".concat(e))}(e).then(function(e){return t(function(e){return{type:"RECEIVE_USER_TWEETS",tweets:e}}(e))}).catch(function(e){return console.log(e)})}},L=function(e){return function(t){return function(e){return v.a.post("/api/tweets/",e)}(e).then(function(e){return t(function(e){return{type:"RECEIVE_NEW_TWEET",tweet:e}}(e))}).catch(function(e){return console.log(e)})}},P=function(e){function t(){return Object(k.a)(this,t),Object(C.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(R.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,this.props.text))}}]),t}(a.a.Component),D=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this,e))).state={text:"",newTweet:""},n.handleSubmit=n.handleSubmit.bind(Object(U.a)(Object(U.a)(n))),n}return Object(_.a)(t,e),Object(R.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({newTweet:e.newTweet.text})}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={text:this.state.text};this.props.composeTweet(t),this.setState({text:""})}},{key:"update",value:function(){var e=this;return function(t){return e.setState({text:t.currentTarget.value})}}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",null,a.a.createElement("input",{type:"textarea",value:this.state.text,onChange:this.update(),placeholder:"Write your tweet..."}),a.a.createElement("input",{type:"submit",value:"Submit"}))),a.a.createElement("br",null),a.a.createElement(P,{text:this.state.newTweet}))}}]),t}(a.a.Component),z=Object(s.b)(function(e){return{currentUser:e.session.user,newTweet:e.tweets.new}},function(e){return{composeTweet:function(t){return e(L(t))}}})(D),G=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this,e))).state={tweets:[]},n}return Object(_.a)(t,e),Object(R.a)(t,[{key:"componentWillMount",value:function(){this.props.fetchTweets()}},{key:"componentWillReceiveProps",value:function(e){this.setState({tweets:e.tweets})}},{key:"render",value:function(){return 0===this.state.tweets.length?a.a.createElement("div",null,"There are no Tweets"):a.a.createElement("div",null,a.a.createElement("h2",null,"All Tweets"),this.state.tweets.map(function(e){return a.a.createElement(P,{key:e._id,text:e.text})}))}}]),t}(a.a.Component),M=Object(p.a)(G),J=Object(s.b)(function(e){return{tweets:Object.values(e.tweets.all)}},function(e){return{fetchTweets:function(){return e(N())}}})(M),B=function(e){function t(){return Object(k.a)(this,t),Object(C.a)(this,Object(I.a)(t).apply(this,arguments))}return Object(_.a)(t,e),Object(R.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("p",null,"A Twitter Clone"),a.a.createElement("footer",null,"Copyright \xa9 2019 Chirper"))}}]),t}(a.a.Component),H=n(17),q=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this,e))).state={email:"",password:"",errors:{}},n.handleSubmit=n.handleSubmit.bind(Object(U.a)(Object(U.a)(n))),n.renderErrors=n.renderErrors.bind(Object(U.a)(Object(U.a)(n))),n}return Object(_.a)(t,e),Object(R.a)(t,[{key:"componentWillReceiveProps",value:function(e){!0===e.currentUser&&this.props.history.push("/tweets"),this.setState({errors:e.errors})}},{key:"update",value:function(e){var t=this;return function(n){return t.setState(Object(H.a)({},e,n.currentTarget.value))}}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email,password:this.state.password};this.props.login(t)}},{key:"renderErrors",value:function(){var e=this;return a.a.createElement("ul",null,Object.keys(this.state.errors).map(function(t,n){return a.a.createElement("li",{key:"error-".concat(n)},e.state.errors[t])}))}},{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",null,a.a.createElement("br",null),a.a.createElement("input",{type:"text",value:this.state.email,onChange:this.update("email"),placeholder:"Email"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password,onChange:this.update("password"),placeholder:"Password"}),a.a.createElement("br",null),a.a.createElement("input",{type:"submit",value:"Submit"}),this.renderErrors())))}}]),t}(a.a.Component),F=Object(p.a)(q),K=Object(s.b)(function(e){return{errors:e.errors.session}},function(e){return{login:function(t){return e(S(t))}}})(F),Q=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this,e))).state={email:"",handle:"",password:"",password2:"",errors:{}},n.handleSubmit=n.handleSubmit.bind(Object(U.a)(Object(U.a)(n))),n.clearedErrors=!1,n}return Object(_.a)(t,e),Object(R.a)(t,[{key:"componentWillReceiveProps",value:function(e){!0===e.signedIn&&this.props.history.push("/login"),this.setState({errors:e.errors})}},{key:"update",value:function(e){var t=this;return function(n){return t.setState(Object(H.a)({},e,n.currentTarget.value))}}},{key:"handleSubmit",value:function(e){e.preventDefault();var t={email:this.state.email,handle:this.state.handle,password:this.state.password,password2:this.state.password2};this.props.signup(t,this.props.history)}},{key:"renderErrors",value:function(){var e=this;return a.a.createElement("ul",null,Object.keys(this.state.errors).map(function(t,n){return a.a.createElement("li",{key:"error-".concat(n)},e.state.errors[t])}))}},{key:"render",value:function(){return a.a.createElement("div",{className:"login-form-container"},a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("div",{className:"login-form"},a.a.createElement("br",null),a.a.createElement("input",{type:"text",value:this.state.email,onChange:this.update("email"),placeholder:"Email"}),a.a.createElement("br",null),a.a.createElement("input",{type:"text",value:this.state.handle,onChange:this.update("handle"),placeholder:"Handle"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password,onChange:this.update("password"),placeholder:"Password"}),a.a.createElement("br",null),a.a.createElement("input",{type:"password",value:this.state.password2,onChange:this.update("password2"),placeholder:"Confirm Password"}),a.a.createElement("br",null),a.a.createElement("input",{type:"submit",value:"Submit"}),this.renderErrors())))}}]),t}(a.a.Component),X=Object(p.a)(Q),Y=Object(s.b)(function(e){return{signedIn:e.session.isSignedIn,errors:e.errors.session}},function(e){return{signup:function(t){return e(y(t))}}})(X),Z=function(e){function t(e){var n;return Object(k.a)(this,t),(n=Object(C.a)(this,Object(I.a)(t).call(this,e))).state={tweets:[]},n}return Object(_.a)(t,e),Object(R.a)(t,[{key:"componentWillMount",value:function(){console.log(this.props.currentUser.id),this.props.fetchUserTweets(this.props.currentUser.id)}},{key:"componentWillReceiveProps",value:function(e){this.setState({tweets:e.tweets})}},{key:"render",value:function(){return 0===this.state.tweets.length?a.a.createElement("div",null,"This user has no Tweets"):a.a.createElement("div",null,a.a.createElement("h2",null,"All of This User's Tweets"),this.state.tweets.map(function(e){return a.a.createElement(P,{key:e._id,text:e.text})}))}}]),t}(a.a.Component),$=Object(s.b)(function(e){return{tweets:Object.values(e.tweets.user),currentUser:e.session.user}},function(e){return{fetchUserTweets:function(t){return e(A(t))}}})(Z),ee=function(){return a.a.createElement("div",null,a.a.createElement(V,null),a.a.createElement(f.a,null,a.a.createElement(m,{exact:!0,path:"/",component:B}),a.a.createElement(m,{exact:!0,path:"/login",component:K}),a.a.createElement(m,{exact:!0,path:"/signup",component:Y}),a.a.createElement(d,{exact:!0,path:"/tweets",component:J}),a.a.createElement(d,{exact:!0,path:"/profile",component:$}),a.a.createElement(d,{exact:!0,path:"/new_tweet",component:z})))},te=function(e){var t=e.store;return a.a.createElement(s.a,{store:t},a.a.createElement(c.a,null,a.a.createElement(ee,null)))},ne=n(13),re=n(37),ae=n(38),oe=n.n(ae),ue=n(26),se={isAuthenticated:!1,user:{}},ce=[],ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(Object.freeze(e),t.type){case"RECEIVE_SESSION_ERRORS":return t.errors;case"RECEIVE_CURRENT_USER":return ce;default:return e}},le=Object(ne.c)({session:ie}),he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{all:{},user:{},new:void 0},t=arguments.length>1?arguments[1]:void 0;Object.freeze(e);var n=Object.assign({},e);switch(t.type){case"RECEIVE_TWEETS":return n.all=t.tweets.data,n;case"RECEIVE_USER_TWEETS":return n.user=t.tweets.data,n;case"RECEIVE_NEW_TWEET":return n.new=t.tweet.data,n;default:return e}},pe=Object(ne.c)({errors:le,session:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RECEIVE_CURRENT_USER":return Object(ue.a)({},e,{isAuthenticated:!!t.currentUser,user:t.currentUser});case"RECEIVE_USER_LOGOUT":return{isAuthenticated:!1,user:void 0};case"RECEIVE_USER_SIGN_IN":return Object(ue.a)({},e,{isSignedIn:!0});default:return e}},tweets:he}),Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(ne.d)(pe,e,Object(ne.a)(re.a,oe.a))};document.addEventListener("DOMContentLoaded",function(){var e;if(localStorage.jwtToken){w(localStorage.jwtToken);var t=j()(localStorage.jwtToken);e=Ee({session:{isAuthenticated:!0,user:t}});var n=Date.now()/1e3;t.exp<n&&(e.dispatch(T()),window.location.href="/login")}else e=Ee({});var r=document.getElementById("root");u.a.render(a.a.createElement(te,{store:e}),r)})}},[[40,2,1]]]);
//# sourceMappingURL=main.038f835a.chunk.js.map